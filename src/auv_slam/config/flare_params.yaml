# Location: src/auv_slam/config/flare_params.yaml
# Flare Detection and Navigation Parameters - Safe Depth Control

flare_detector_node:
  ros__parameters:
    # Flare specifications: 80cm tall, 1.6cm diameter
    # Golf ball on top: 2.1cm radius
    min_flare_area: 200          # Small cross-section (thin rod)
    max_flare_area: 3000         # Upper limit to reject gate posts
    min_aspect_ratio: 8.0        # Very tall and thin (80cm / 1.6cm â‰ˆ 50)
    max_aspect_ratio: 50.0       # Extremely thin upper limit
    min_circularity: 0.3         # Somewhat circular when viewed
    
    # Detection stability
    min_confirmations: 3
    detection_history_size: 5
    
    # HSV ranges for flares
    red_hsv:
      lower1: [0, 120, 70]
      upper1: [8, 255, 255]
      lower2: [172, 120, 70]
      upper2: [180, 255, 255]
    
    yellow_hsv:
      lower: [20, 100, 100]
      upper: [30, 255, 255]
    
    blue_hsv:
      lower: [100, 150, 50]
      upper: [130, 255, 255]
    
    morph_kernel_size: 3
    publish_debug: true

flare_navigator_node:
  ros__parameters:
    # =========================================================================
    # CRITICAL DEPTH SAFETY SETTINGS
    # =========================================================================
    # Flares are positioned:
    #   - Bottom at floor: -1.6m (ON THE FLOOR)
    #   - Center: -1.2m
    #   - Top (without golf ball): -0.8m
    #   - Golf ball top: -0.779m
    #
    # CRITICAL: To "bump" flares safely, bot must be at -0.8m to -1.0m
    # NEVER go deeper than -1.2m or you'll hit the floor!
    
    # Safe Waiting Depth (initial stabilization)
    target_depth: -0.8          # Safe shallow depth for waiting
    
    # Mission Depth (for bumping flares)
    mission_depth: -1.0         # Operating depth (safe from floor)
    max_mission_depth: -1.2     # HARD LIMIT - never exceed
    
    # Depth control tuning
    depth_tolerance: 0.15
    depth_correction_gain: 1.0
    max_vertical_speed: 0.3     # Slow descent for safety
    
    # Navigation speeds
    search_speed: 0.4
    approach_speed: 0.4
    bump_speed: 0.5
    
    # Distance thresholds
    bump_distance_threshold: 0.8
    alignment_threshold: 0.15
    
    # Timing
    bump_duration: 4.0
    verification_time: 2.0